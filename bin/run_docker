#!/usr/bin/bash
set -x
GIGAHORSE_ROOT="$(dirname "$(dirname "$(readlink -fm "$0")")")"
CLIENT_WD=/user
mkdir -p ${GIGAHORSE_ROOT}/.temp ${GIGAHORSE_ROOT}/cache

docker run \
    -v $(pwd):${CLIENT_WD} \
    --mount type=bind,source=${GIGAHORSE_ROOT}/.temp,target=/opt/gigahorse/gigahorse-toolchain/.temp \
    --mount type=bind,source=${GIGAHORSE_ROOT}/cache,target=/opt/gigahorse/gigahorse-toolchain/cache \
    -u `id -u $USER`:`id -g $USER` \
    -w ${CLIENT_WD} \
    -it gigahorse $@
